<html>
<head>
<style>
  .block {
    display: block;
	margin-bottom: 10px;
	width: 100%;
  }
  #quote {
    background: #ffaaaa;
	height: 100px;
  }
  #imageurl{
	background: #aaffaa;
	height: 100px;
  }
  .button {
    width: 30%;
	height: 100px;
	margin-bottom: 50px;
	margin-right: 20px;
  }
  .mid {
    text-align: center;
  }
  #square {
    //border: 20px #dddddd solid;
	text-align: center;
	width: 100%;
	margin-bottom: 100px;
  }
  #prettyquote {
    width: auto;
	font-family: Georgia;
	text-align: center;
	padding-top: 20px;
	padding-bottom: 5px;
  }
  .font20 {
	font-size: 20pt;
	font-family: Arial;
  }
</style>
</head>
<body>

<div class="mid">
<div class="font20">
  Quote:
  <textarea class="block font20" id="quote"></textarea>
  Image URL:
  <input id="imageurl" class="block font20" value=""></input>
  <input id="applybutton" class="button font20" type="button" value="Apply" onclick="apply();"></input>
  <input id="smallerbutton" class="button font20" type="button" value="Smaller" onclick="smaller();"></input>
  <input id="biggerbutton" class="button font20" type="button" value="Bigger" onclick="bigger();"></input>
</div>

<div id="square">
  <div id="prettyquote"></div>
  <img id="author"></img>
</div>
</div>

<script>
var square = document.getElementById("square");
w = square.offsetWidth;
h = w;
square.style.height = h + "px";

var quote = document.getElementById("quote");
var prettyquote = document.getElementById("prettyquote");
var landscape = false;

function setPrettyQuoteFontSize(s){
  prettyquote.style.fontSize = s + "pt";
}
var s = 20;
setPrettyQuoteFontSize(s);

var imageurl = document.getElementById("imageurl");
var author = document.getElementById("author");

function resizeImage(){
  imageheight = h - prettyquote.offsetHeight;
  author.style.height = imageheight + "px";
  author.style.width = "auto";
  imagewidth = author.offsetWidth;
  squarewidth = prettyquote.offsetWidth;
  if(landscape && imagewidth > squarewidth){
	//imageheight = squarewidth / imagewidth * imageheight;
	//author.style.height = imageheight + "px";
	author.style.height = "auto";
	imagewidth = squarewidth
	author.style.width = imagewidth + "px";
  }
}

function apply(){
  quoteless = quote.value.replace(/\"/g, "");
  quoteparts = quoteless.split("\n");
  authorformatted = quoteparts[2];
  if(authorformatted && !authorformatted.startsWith("- ")){
	authorformatted = "- " + authorformatted;
  }
  quoteformatted = "\"" + quoteparts[0] + "\"<br><br>" + authorformatted;
  prettyquote.innerHTML = quoteformatted;
  
  author.onload = function(){
    landscape = author.width > author.height;
    resizeImage();
  }
  author.src = imageurl.value;
}

function smaller(){
  s -= 2;
  setPrettyQuoteFontSize(s);
  resizeImage()
}

function bigger(){
  s += 2;
  setPrettyQuoteFontSize(s);
  resizeImage()
}
</script>
</body>
</html>